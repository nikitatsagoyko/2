!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){!function(a,d){"use strict";var e=function(a){if("object"!=typeof a.document)throw new Error("Cookies.js requires a `window` with a `document` object");var b=function(a,c,d){return 1===arguments.length?b.get(a):b.set(a,c,d)};return b._document=a.document,b._cacheKeyPrefix="cookey.",b._maxExpireDate=new Date("Fri, 31 Dec 9999 23:59:59 UTC"),b.defaults={path:"/",secure:!1},b.get=function(a){b._cachedDocumentCookie!==b._document.cookie&&b._renewCache();var c=b._cache[b._cacheKeyPrefix+a];return c===d?d:decodeURIComponent(c)},b.set=function(a,c,e){return e=b._getExtendedOptions(e),e.expires=b._getExpiresDate(c===d?-1:e.expires),b._document.cookie=b._generateCookieString(a,c,e),b},b.expire=function(a,c){return b.set(a,d,c)},b._getExtendedOptions=function(a){return{path:a&&a.path||b.defaults.path,domain:a&&a.domain||b.defaults.domain,expires:a&&a.expires||b.defaults.expires,secure:a&&a.secure!==d?a.secure:b.defaults.secure}},b._isValidDate=function(a){return"[object Date]"===Object.prototype.toString.call(a)&&!isNaN(a.getTime())},b._getExpiresDate=function(a,c){if(c=c||new Date,"number"==typeof a?a=a===1/0?b._maxExpireDate:new Date(c.getTime()+1e3*a):"string"==typeof a&&(a=new Date(a)),a&&!b._isValidDate(a))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return a},b._generateCookieString=function(a,b,c){a=a.replace(/[^#$&+\^`|]/g,encodeURIComponent),a=a.replace(/\(/g,"%28").replace(/\)/g,"%29"),b=(b+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent),c=c||{};var d=a+"="+b;return d+=c.path?";path="+c.path:"",d+=c.domain?";domain="+c.domain:"",d+=c.expires?";expires="+c.expires.toUTCString():"",d+=c.secure?";secure":""},b._getCacheFromString=function(a){for(var c={},e=a?a.split("; "):[],f=0;f<e.length;f++){var g=b._getKeyValuePairFromCookieString(e[f]);c[b._cacheKeyPrefix+g.key]===d&&(c[b._cacheKeyPrefix+g.key]=g.value)}return c},b._getKeyValuePairFromCookieString=function(a){var b=a.indexOf("=");b=b<0?a.length:b;var c,d=a.substr(0,b);try{c=decodeURIComponent(d)}catch(a){console&&"function"==typeof console.error&&console.error('Could not decode cookie with key "'+d+'"',a)}return{key:c,value:a.substr(b+1)}},b._renewCache=function(){b._cache=b._getCacheFromString(b._document.cookie),b._cachedDocumentCookie=b._document.cookie},b._areEnabled=function(){var a="cookies.js",c="1"===b.set(a,1).get(a);return b.expire(a),c},b.enabled=b._areEnabled(),b},f=a&&"object"==typeof a.document?e(a):e;"function"==typeof define&&define.amd?define(function(){return f}):"object"==typeof c?("object"==typeof b&&"object"==typeof b.exports&&(c=b.exports=f),c.Cookies=f):a.Cookies=f}("undefined"==typeof window?this:window)},{}],2:[function(a,b,c){function d(a,b){b=b||{},this.options=b,this.productKey=a,this.bookmarksServer=new f,this.request=null,this.$checkboxes=$(b.selectors.checkboxes),this.$text=$(b.selectors.text),this.profileUrl=e.secureProjectUrl("profile","/login/?redirect=")+encodeURIComponent(location.href.replace(/#$/,"")+"#add-bookmark"),this.attachEvents()}var e=a("./modules/url.js"),f=a("./modules/BookmarksServer.js"),g=a("./modules/Credentials.js");window.Onliner=window.Onliner||{},window.Onliner.Bookmarks=d,d.prototype.initialBehavior=function(){var a=window.location.hash;g.isAuth()&&("#add-bookmark"===a?this.add():this.check()),"#add-bookmark"===a&&e.removeHash()},d.prototype.attachEvents=function(){var a=this;this.$checkboxes.change(function(){var b=$(this);if(!g.isAuth())return void e.redirect(a.profileUrl);b.prop("checked")?a.add():a.remove(),window.ga&&ga("catalogContext.send","event","Knopka","Zakladka"),window.ga&&ga("catalog.send","event","Добавить в закладки")})},d.prototype.check=function(){var a=this,b={};b.success=function(){a.doChecked()},b.error=function(b){404===b.response.status&&a.undoChecked()},b.complete=function(){a.request=null},this.request&&this.request.cancel(),this.request=this.bookmarksServer.check(this.productKey,b)},d.prototype.add=function(){var a=this,b={};b.success=function(){window.product_details&&window.dataLayer&&window.dataLayer.push&&(window.dataLayer.push({ecommerce:null}),window.dataLayer.push({event:"add_to_wishlist",ecommerce:window.product_details})),window.mindbox&&mindbox("async",{operation:"Mobile.AddToWishList",data:{addProductToList:{product:{ids:{backend:a.productKey}},pricePerItem:window.product_details&&window.product_details.value||0}}})},b.error=function(){a.undoChecked()},b.complete=function(){a.request=null},this.request&&this.request.cancel(),this.doChecked(),this.request=this.bookmarksServer.add(this.productKey,b)},d.prototype.remove=function(){var a=this,b={};b.success=function(){window.mindbox&&mindbox("async",{operation:"Mobile.RemoveFromWishList",data:{removeProductFromList:{product:{ids:{backend:a.productKey}},pricePerItem:window.product_details&&window.product_details.value||0}}})},b.error=function(){a.doChecked()},b.complete=function(){a.request=null},this.request&&this.request.cancel(),this.undoChecked(),this.request=this.bookmarksServer.remove(this.productKey,b)},d.prototype.doChecked=function(){var a=this.options.texts||{};this.$checkboxes.prop("checked",!0),this.$text.text(a.checked)},d.prototype.undoChecked=function(){var a=this.options.texts||{};this.$checkboxes.prop("checked",!1),this.$text.text(a.unchecked)}},{"./modules/BookmarksServer.js":3,"./modules/Credentials.js":4,"./modules/url.js":5}],3:[function(a,b,c){function d(){this.apiService=new e({baseURL:"/sdapi/catalog.api/bookmarks",authorization:{useToken:!0}})}var e=window.ApiService;d.prototype.check=function(a,b){var c={url:"/"+a,method:"head",callbacks:b,errors:{silentCodes:[404]}};return this.apiService.query(c)},d.prototype.add=function(a,b){var c={url:"/",method:"post",data:{product_keys:[].concat(a)},callbacks:b};return this.apiService.query(c)},d.prototype.remove=function(a,b){var c={url:"/",method:"delete",data:{product_keys:[].concat(a)},callbacks:b};return this.apiService.query(c)},b.exports=d},{}],4:[function(a,b,c){!function(c,d){"object"==typeof b&&"object"==typeof b.exports?b.exports=d(a("cookies-js")):c.Credentials=d(window.Cookies)}(this,function(a){function b(){}return b.isAuth=function(){var b=window.MODELS&&window.MODELS.currentUser||null;return!!a.get("logged_in")&&!(!b||!b.id())},b})},{"cookies-js":1}],5:[function(a,b,c){!function(a,c){"object"==typeof b&&"object"==typeof b.exports?b.exports=c:a.URL=c}(this,function(){function a(a,b){a=_.compact(a);var c=window.location,d=(a.length?"?":"")+a.join("&"),e=c.origin+c.pathname+d+c.hash;b?window.history.replaceState({},"",e):window.history.pushState({},"",e)}var b={};return b.baseDomain=function(){return document.location.host.split(".").slice(-2).join(".")}(),b.projectDomain=function(a){return a+"."+b.baseDomain},b.projectUrl=function(a,c,d){return c=c?c.replace(/^\/*/,"/"):"",(d=d||"http://")+b.projectDomain(a)+c},b.secureProjectUrl=function(a,c){return b.projectUrl(a,c,"https://")},b.composeSecondOfferPrivateMessageUrl=function(a){return b.secureProjectUrl("chats","/compose/"+a.user.id+"/second/"+a.id)},b.redirect=function(a){document.location.href=a},b.removeHash=function(){history.replaceState("",document.title,window.location.pathname+window.location.search)},b.queryParamsToJson=function(){var a=window.location.search.replace("?",""),b={};try{b=JSON.parse('{"'+decodeURI(a).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')}catch(a){}return b},b.setParameterToQueryString=function(b,c,d){var e=(window.location.search||"").replace(/(^\?)/,""),f=b+"="+c,g=_.compact(e.split("&")),h=_.map(g,function(a){return a.split("=")[0]===b?f:a});_.find(h,function(a){return a.split("=")[0]===b})||h.push(f),a(h,d)},b.removeParameterFromQueryString=function(b,c){var d=(window.location.search||"").replace(/(^\?)/,""),e=_.compact(d.split("&"));a(_.filter(e,function(a){return a.split("=")[0]!==b}),c)},b.getUrlWithRegion=function(a){var b=new URL(window.location.href),c=new URL(a),d=b.searchParams.get("region");return d?(c.searchParams.set("region",d),c.href):(c.searchParams.delete("region"),c.href)},b}())},{}]},{},[2]);